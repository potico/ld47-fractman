pico-8 cartridge // http://www.pico-8.com
version 29
__lua__

sz = {
  [0]=2, 1.83, 1.68, 1.54, 1.41, 1.30, 1.19, 1.09,
  1, 1, 1, 1, 1, 1, 1, 1
}
ssz = {}
for i=0,#sz-1 do ssz[i] = (ssz[i-1] or 0) + sz[i] end

function _init()
  ply =
  {
    -- z is 0..3
    x=4,y=5,z=1
  }
  test = 1
end

function _update()
  if btn(0) then ply.x-=1 end
  if btn(1) then ply.x+=1 end
  if btn(2) then ply.y-=1 end
  if btn(3) then ply.y+=1 end
  test *= 1.01
  while test >= 2 do test /= 2 end
end

function _draw()
  cls()
  local delta = 128-128*test
  draw_map(delta, delta,8*test)
  draw_map(64+delta/2,64+delta/2,4*test)
  draw_map(96+delta/4,96+delta/4,2*test)
  draw_map(112+delta/8,112+delta/8,1*test)
  draw_map(120+delta/16,120+delta/16,test/2)
  spr(52,46,20)
end

function draw_map(x0,y0,w)
--x0*=1.5 x0-=40
--y0*=1.5 y0-=40
--w*=1.5
  -- draw background
  fillp(0x5a5a.8)
  for j=0,15 do
    for i=0,15 do
      if mget(i,j)>2 then
        if i<8 or j<8 then
          --local size=w*(1-min(i,j)/16)
          local size = w * sz[min(i,j)]/2
          local x,y = x0+i*w,y0+j*w
--size=w
          rectfill(x-size*.75,y-size*.75,x+size*.75+1,y+size*.75+1,12)
          --rect(x-size*.75,y-size*.75,x+size*.75+1,y+size*.75+1,10)
        end
      end
    end
  end
  fillp()
  -- draw empty space
  for j=0,15 do
    for i=0,15 do
      if i<8 or j<8 then
        if mget(i,j)<=2 then
          --local size=w*(1-min(i,j)/16)
          local size = w * sz[min(i,j)]/2
          local x,y = x0+i*w,y0+j*w
          rectfill(x-size*.75,y-size*.75,x+size*.75,y+size*.75,0)
          --rect(x-size*.75,y-size*.75,x+size*.75,y+size*.75,3)
        end
      end
    end
  end
  -- draw pellets
  for j=0,15 do
    for i=0,15 do
      if i<8 or j<8 then
        if mget(i,j)<=2 then
          --local size=w*(1-min(i,j)/16)
          local size = w * sz[min(i,j)]/2
          local x,y = x0+i*w,y0+j*w
          --circfill(x,y,size/6,7)
          rectfill(x-size/8,y-size/8,x+size/8,y+size/8,7)
        end
      end
    end
  end
end

__gfx__
0000000000000000000000000000000000c00c00000000000000000000c00c00000000000000000000000c0000c0000000000000000000000000000000000000
0000000000000000000000000000000000c00c00000000000000000000c00c00000000000000000000000c0000c0000000000000000000000000000000000000
000000000057750000000000cccccccc00c00c00000cc000000ccccc00c00c00ccccc00000000000000000cccc00000000000000000000000000000000000000
0000000000777700000770000000000000c00c0000c00c0000c0000000c00c0000000c0000000000000000000000000000000000000000000000000000000000
0000000000777700000770000000000000c00c0000c00c0000c0000000c00c0000000c0000000000000000000000000000000000000000000000000000000000
000000000057750000000000cccccccc00c00c0000c00c00000ccccc000cc000ccccc000000000cc0000000000000000cc000000000000000000000000000000
0000000000000000000000000000000000c00c0000c00c0000000000000000000000000000000c00000000000000000000c00000000000000000000000000000
0000000000000000000000000000000000c00c0000c00c0000000000000000000000000000000c00000000000000000000c00000000000000000000000000000
0000000000c0000000000c00000000000000000000c000000000000000000c000000000000c00c0000c00c000000000000000000000000000000000000000000
0000000000c0000000000c00000000000000000000c000000000000000000c000000000000c00c0000c00c000000000000000000000000000000000000000000
0000cccc00c0000000000c00cccc0000cccccccc00c000000000000000000c000000cccc00c000cccc000c00cccc000000000000000000000000000000000000
000c000000c0000000000c000000c0000000000000c000000000000000000c00000c000000c0000000000c000000c00000000000000000000000000000000000
00c00000000c00000000c00000000c000000000000c000000000000000000c0000c00000000c00000000c00000000c0000000000000000000000000000000000
00c000000000cccccccc000000000c000000000000c00000cccccccc00000c0000c000cc0000cccccccc0000cc000c0000000000000000000000000000000000
00c00000000000000000000000000c000000000000c000000000000000000c0000c00c00000000000000000000c00c0000000000000000000000000000000000
00c00000000000000000000000000c000000000000c000000000000000000c0000c00c00000000000000000000c00c0000000000000000000000000000000000
00c0000000c00c0000c00c0000000c000000000000000c0000c00000000000000000000000c00c0000c00c0000c00c0000000000000000000000000000000000
00c0000000c00c0000c00c0000000c000000000000000c0000c00000000000000000000000c00c0000c00c0000c00c0000000000000000000000000000000000
00c0000000c000cccc000c0000000c00cccccccc000000cccc000000cccccccccccccccc00c000cccc0000cccc000c0000000000000000000000000000000000
00c0000000c0000000000c0000000c00000000000000000000000000000000000000000000c000000000000000000c0000000000000000000000000000000000
00c0000000c0000000000c0000000c00000000000000000000000000000000000000000000c000000000000000000c0000000000000000000000000000000000
00c000cc00c0000000000c00cc000c00000000cccccccccccccccccccc000000cc0000cc00c000cccccccccccc000c0000000000000000000000000000000000
00c00c0000c0000000000c0000c00c0000000c00000000000000000000c0000000c00c0000c00c000000000000c00c0000000000000000000000000000000000
00c00c0000c0000000000c0000c00c0000000c00000000000000000000c0000000c00c0000c00c000000000000c00c0000000000000000000000000000000000
88888888cccccccc000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc00000000000000000aaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc0000000000000000aaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc0000000000000000aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc0000000000000000aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc0000000000000000aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc00000000000000000aaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888cccccccc000000000000000000aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0916161616161616161202111616161600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702020102020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702101424030308020603030802101400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702111612020202020202020202111600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702020202020603030303030802020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1202050205020202020202020202101400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202040219031b02060308020603261600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
24031a0202020402020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702020205020402303030303002303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
170206032b020402303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702020204020702303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702050204020202023030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702040204020603303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702040207020202303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702040202020502303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1702211414142202303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
